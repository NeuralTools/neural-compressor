:orphan:

:py:mod:`neural_compressor.torch.algorithms.weight_only.rtn`
============================================================

.. py:module:: neural_compressor.torch.algorithms.weight_only.rtn


Module Contents
---------------


Functions
~~~~~~~~~

.. autoapisummary::

   neural_compressor.torch.algorithms.weight_only.rtn.rtn_quantize



.. py:function:: rtn_quantize(model, num_bits=4, group_size=32, scheme='asym', quantile=1.0, weight_config={}, return_int=False, dtype='int', enable_full_range=False, enable_mse_search=False, group_dim=1, **kwargs)

   Quant the model with round to nearest method.

   :param model: torch module
   :param num_bits: num bits. Defaults to 4.
   :param group_size: how many elements share one scale/zp. Defaults to 32.
   :type group_size: int, optional
   :param scheme: sym or asym. Defaults to "asym".
   :type scheme: str, optional
   :param quantile: percentile of clip. Defaults to 1.0.
   :type quantile: float, optional
   :param dtype: select from int, nf4, fp4. Defaults to int.
   :type dtype: str, optional
   :param weight_config: specific layer wise configurations. Defaults to {}.
                         For example,
                             weight_config={
                                 'fc2':
                                     {
                                         'dtype': 'int',
                                         'bits': 4,
                                         'group_size': 32,
                                         'scheme': 'sym'
                                         'gptq_perm': [1, 1, ...] # for gptq perm
                                     }
                             }
   :type weight_config: dict, optional
   :param return_int: Choose return fp32 or int32 model.
                      Defaults to False.
   :type return_int: bool, optional
   :param enable_full_range: Choose sym range whether use -2**(bits-1).
                             Defaults to False.
   :type enable_full_range: bool, optional
   :param enable_mse_search: Whether search clip range.
                             Defaults to True.
   :type enable_mse_search: bool, optional
   :param group_dim: 0 means splitting output channel,
                     1 means splitting input channel. Defaults to 1.
   :type group_dim: int, optional

   :returns: fake quantized torch module
   :rtype: model


